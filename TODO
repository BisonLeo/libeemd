separate x and res from emd_workspace struct
replace division with array_div with multiplication
